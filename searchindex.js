Search.setIndex({"docnames": ["benchmarks", "index", "reference_guide", "tutorial"], "filenames": ["benchmarks.rst", "index.rst", "reference_guide.rst", "tutorial.ipynb"], "titles": ["Benchmarks", "Sparse accumulation", "accumulate", "Sparse accumulation"], "terms": {"todo": [0, 1, 3], "here": [0, 3], "thi": [1, 2, 3], "packag": [1, 3], "contain": [1, 3], "significantli": 1, "optim": [1, 3], "cpu": [1, 2, 3], "gpu": [1, 3], "pytorch": [1, 3], "extens": [1, 3], "oper": [1, 3], "we": [1, 3], "call": [1, 2, 3], "take": [1, 2, 3], "two": [1, 3], "input": [1, 3], "arrai": [1, 3], "x_1": [1, 3], "x_2": [1, 3], "produc": [1, 3], "an": [1, 3], "output": [1, 3], "one": [1, 2, 3], "given": [1, 3], "transform": 1, "rule": 1, "defin": [1, 2, 3], "dimension": [1, 3], "m_1": [1, 3], "m_2": [1, 3], "mu": [1, 3], "c": [1, 3], "The": [1, 3], "function": [1, 2], "form": 1, "can": [1, 3], "best": 1, "explain": 1, "follow": 1, "pseudocod": 1, "torch": [1, 2, 3], "zero": [1, 3], "output_s": [1, 2, 3], "index": [1, 3], "rang": [1, 3], "shape": [1, 3], "0": [1, 3], "i": [1, 3], "requir": [1, 3], "so": [1, 3], "3": [1, 3], "equivari": 1, "neural": 1, "network": 1, "other": [1, 3], "machin": 1, "learn": 1, "model": 1, "fundament": 1, "build": 1, "block": 1, "method": [1, 3], "clebsch": 1, "gordan": 1, "iter": 1, "where": [1, 3], "c_": [1, 3], "l_1": 1, "l_2": 1, "l_": 1, "ar": [1, 3], "coeffici": [1, 3], "These": 1, "particularli": 1, "complex": 1, "valu": [1, 3], "version": 1, "sparsiti": 1, "pattern": 1, "onli": [1, 3], "non": [1, 3], "For": 1, "real": [1, 3], "more": 1, "complic": 1, "still": 1, "small": 1, "ratio": 1, "entri": 1, "thu": [1, 3], "make": [1, 3], "sens": [1, 3], "store": [1, 3], "In": 1, "case": [1, 3], "need": [1, 2, 3], "provid": [1, 3], "addit": 1, "indic": [1, 3], "inform": 1, "about": 1, "correspond": [1, 3], "With": 1, "data": 1, "organ": 1, "cg": [1, 3], "fall": 1, "abov": [1, 3], "our": [1, 3], "show": 1, "custom": 1, "while": [1, 2], "being": 1, "memori": [1, 3], "effici": 1, "faster": 1, "compar": [1, 3], "all": [1, 2, 3], "altern": [1, 3], "implement": [1, 3], "were": 1, "abl": 1, "come": 1, "up": [1, 3], "includ": 1, "dens": [1, 3], "matrix": 1, "multipl": 1, "lot": 1, "insid": [1, 3], "due": 1, "us": [1, 3], "engin": 1, "reli": 1, "index_add": 1, "against": 1, "e3nn": 1, "measur": 1, "detail": 1, "found": 1, "section": 1, "python3": 1, "m": 1, "pip": 1, "pytest": 1, "test_cpp_jit_cuda": 1, "py": [1, 3], "vra": 1, "test_cpp_contigu": 1, "option": 1, "outdat": 1, "get_cg_transformation_rul": [1, 3], "cgcalculatorsingl": [1, 3], "sparse_accumul": [2, 3], "x1": [2, 3], "x2": [2, 3], "idx_output": [2, 3], "idx_1": [2, 3], "idx_2": [2, 3], "multipli": [2, 3], "l1": [2, 3], "l2": [2, 3], "l_output": [2, 3], "dtype": [2, 3], "float32": 2, "devic": [2, 3], "class": [2, 3], "forward": [2, 3], "comput": [2, 3], "perform": [2, 3], "everi": 2, "should": 2, "overridden": 2, "subclass": 2, "although": 2, "recip": 2, "pass": 2, "within": 2, "modul": 2, "instanc": 2, "afterward": 2, "instead": 2, "sinc": [2, 3], "former": 2, "care": 2, "run": 2, "regist": 2, "hook": 2, "latter": 2, "silent": 2, "ignor": 2, "them": [2, 3], "1": 3, "import": 3, "numpi": 3, "np": 3, "from": 3, "let": 3, "": 3, "some": 3, "plai": 3, "2": 3, "randn": 3, "10": 3, "20": 3, "4": 3, "m1": 3, "longtensor": 3, "m2": 3, "floattensor": 3, "17": 3, "23": 3, "9": 3, "42": 3, "tensor": 3, "sort": 3, "work": 3, "correctli": 3, "It": 3, "veri": 3, "clear": 3, "result": 3, "doesn": 3, "t": 3, "chang": 3, "simultan": 3, "permut": 3, "summat": 3, "depend": 3, "order": 3, "term": 3, "alwai": 3, "reachabl": 3, "have": 3, "achiev": 3, "simpli": 3, "argsort": 3, "main": 3, "which": 3, "doe": 3, "invok": 3, "like": 3, "print": 3, "size": 3, "locat": 3, "wa": 3, "intern": 3, "now": 3, "move": 3, "5": 3, "x1_cuda": 3, "cuda": 3, "x2_cuda": 3, "m1_cuda": 3, "m2_cuda": 3, "mu_cuda": 3, "c_cuda": 3, "exactli": 3, "same": 3, "6": 3, "time": 3, "kernel": 3, "interen": 3, "7": 3, "If": 3, "want": 3, "do": 3, "actual": 3, "popul": 3, "8": 3, "93": 3, "mention": 3, "ha": 3, "been": 3, "alreadi": 3, "covari": 3, "vector": 3, "l": 3, "11": 3, "wrap": 3, "step": 3, "dure": 3, "initi": 3, "next": 3, "calc": 3, "support": 3, "conveni": 3, "realloc": 3, "12": 3, "constitut": 3, "buffer": 3, "paramet": 3, "thei": 3, "add": 3, "rais": 3, "error": 3, "share": 3, "insuffici": 3, "fallback": 3, "select": 3, "goal": 3, "text": 3, "sum": 3, "limits_": 3, "subpart": 3, "fix": 3, "first": 3, "dimens": 3, "ones": 3, "worthwhil": 3, "align": 3, "suppli": 3, "supplementari": 3, "tell": 3, "u": 3, "what": 3, "refer": 3, "slow": 3, "python": 3, "simpl": 3, "13": 3, "def": 3, "sparse_accumulation_loop": 3, "must": 3, "blah": 3, "return": 3, "just": 3, "singl": 3, "integ": 3, "desir": 3, "length": 3, "loop": 3, "go": 3, "over": 3, "current": 3, "contribut": 3, "ad": 3, "proper": 3, "place": 3, "introduc": 3, "keep": 3, "mind": 3, "batch": 3, "featur": 3, "you": 3, "possibl": 3, "itself": 3, "e": 3, "onc": 3, "begin": 3, "repo": 3, "among": 3, "thing": 3, "code": 3, "14": 3, "clebsch_gordan": 3, "clebschgordan": 3, "get_real_clebsch_gordan": 3, "l_max": 3, "precomputed_": 3, "m1_align": 3, "m2_align": 3, "mu_align": 3, "el": 3, "append": 3, "126": 3, "wrapper": 3, "sympi": 3, "definit": 3, "consist": 3, "librasc": 3, "spheric": 3, "harmon": 3, "nice": 3, "wigner": 3, "rascalin": 3, "15": 3, "100": 3, "output_loop": 3, "look": 3, "benchmark": 3, "file": 3, "along": 3, "out": 3, "get": 3, "idea": 3, "how": 3, "properli": 3, "synchron": 3, "speed": 3, "naiv": 3}, "objects": {"sparse_accumulation": [[2, 0, 1, "", "CGCalculatorSingle"], [2, 2, 1, "", "accumulate"], [2, 2, 1, "", "get_cg_transformation_rule"]], "sparse_accumulation.CGCalculatorSingle": [[2, 1, 1, "", "forward"]]}, "objtypes": {"0": "py:class", "1": "py:method", "2": "py:function"}, "objnames": {"0": ["py", "class", "Python class"], "1": ["py", "method", "Python method"], "2": ["py", "function", "Python function"]}, "titleterms": {"benchmark": [0, 1], "spars": [1, 3], "accumul": [1, 2, 3], "instal": 1, "test": 1, "tutori": 1, "refer": 1, "guid": 1, "get_cg_transformation_rul": 2, "cgcalculatorsingl": 2, "prepar": 3, "dummi": 3, "data": 3, "function": 3, "option": 3, "clebsch": 3, "gordan": 3, "iter": 3, "precomput": 3, "transform": 3, "rule": 3, "calcul": 3, "outdat": 3}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "nbsphinx": 4, "sphinx": 57}, "alltitles": {"Benchmarks": [[0, "benchmarks"], [1, null]], "Sparse accumulation": [[1, "sparse-accumulation"], [3, "Sparse-accumulation"]], "Installation": [[1, "installation"]], "Tests": [[1, "tests"]], "Tutorial": [[1, null]], "Reference Guide": [[1, null]], "accumulate": [[2, "accumulate"]], "get_cg_transformation_rule": [[2, "get-cg-transformation-rule"]], "CGCalculatorSingle": [[2, "cgcalculatorsingle"]], "Preparing a dummy data": [[3, "Preparing-a-dummy-data"]], "accumulate function": [[3, "accumulate-function"]], "[optional] Clebsch-Gordan iteration": [[3, "[optional]-Clebsch-Gordan-iteration"]], "precomputing Clebsch-Gordan transformation rule": [[3, "precomputing-Clebsch-Gordan-transformation-rule"]], "Clebsch-Gordan Calculator": [[3, "Clebsch-Gordan-Calculator"]], "Outdated": [[3, "Outdated"]]}, "indexentries": {"cgcalculatorsingle (class in sparse_accumulation)": [[2, "sparse_accumulation.CGCalculatorSingle"]], "accumulate() (in module sparse_accumulation)": [[2, "sparse_accumulation.accumulate"]], "forward() (sparse_accumulation.cgcalculatorsingle method)": [[2, "sparse_accumulation.CGCalculatorSingle.forward"]], "get_cg_transformation_rule() (in module sparse_accumulation)": [[2, "sparse_accumulation.get_cg_transformation_rule"]]}})